<ion-header [translucent]="true">
  <ion-toolbar color="tertiary">
    <ion-buttons slot="start">
      <app-back-button></app-back-button>
    </ion-buttons>
    <ion-title>{{ publicationTitle() }}</ion-title>
    <ion-buttons slot="primary">
      @if (!isReorderMode()) {
      <ion-button (click)="presentActionSheet()">
        <ion-icon name="ellipsis-horizontal-outline"></ion-icon>
      </ion-button>
      } @else {
      <ion-button [disabled]="!isDirty()" (click)="resetOrder()">
        Undo
      </ion-button>
      }
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="content-container">
    <ion-list>
      <ion-reorder-group
        [disabled]="!isReorderMode()"
        (ionItemReorder)="handleReorder($any($event))">
        @for (topic of topics(); track topic._id) { @if (topic.type ===
        'article') {
        <ion-item-sliding #slidingItem>
          <ion-item
            button
            [detail]="!isReorderMode()"
            (click)="navigateToArticle(topic)">
            <ion-label>
              <h2>{{ topic.title }}</h2>
              <p>{{ topic.subtitle }}</p>
            </ion-label>
            <ion-reorder slot="end"></ion-reorder>
          </ion-item>
          <ion-item-options>
            <ion-item-option
              color="danger"
              (click)="onDeleteArticle(topic, slidingItem)">
              <ion-icon name="trash" slot="icon-only"></ion-icon>
            </ion-item-option>
          </ion-item-options>
        </ion-item-sliding>
        } }
      </ion-reorder-group>
    </ion-list>

    <ion-toast
      [isOpen]="isToastOpen()"
      message="Article deleted successfully."
      [duration]="2000"
      (didDismiss)="isToastOpen.set(false)"></ion-toast>
  </div>
</ion-content>
